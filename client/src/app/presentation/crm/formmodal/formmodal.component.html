<app-dialog [(visible)]="displayModal"
  [breakpoints]="{ '1920px': '60vw', '1366px': '70vw', '960px': '85vw', '640px': '95vw' }"
  (visibleChange)="visibleChange($emit)">

  <p-tabs value="0">
    <p-tablist>
      <p-tab value="0">Kayıt EKranı</p-tab>
      <p-tab *ngIf="pageForm.controls['id'].value" value="1">İşlem Tablosu</p-tab>
      <p-tab *ngIf="pageForm.controls['id'].value" value="2">SMS Gönder</p-tab>
      <p-tab *ngIf="pageForm.controls['id'].value" value="3">Satış İşlemleri</p-tab>
    </p-tablist>

    <p-tabpanels>

      <p-tabpanel value="0">
        <p-fluid>

          <form [formGroup]="pageForm">
            <app-select-branch [form]="pageForm"></app-select-branch>

            <div class="grid grid-cols-12 gap-4">

              <div class="col-span-12 md:col-span-4">
                <label for="phone">Telefon</label>
                <p-inputMask id="phone" formControlName="phone" class="w-full" [mask]="'(999) 999 99 99'"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('phone')" (onBlur)="checkPhone()" />
                <app-validation-message [control]="pageForm.controls['phone']" />
              </div>

              <!-- First & Last Name -->
              <div class="col-span-12 md:col-span-4">
                <label for="firstName">Ad</label>
                <input id="firstName" pInputText formControlName="firstName"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('firstName')" />
                <app-validation-message [control]="pageForm.controls['firstName']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="lastName">Soyad</label>
                <input id="lastName" pInputText formControlName="lastName"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('lastName')" />
                <app-validation-message [control]="pageForm.controls['lastName']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="dataProviderId">Data Sağlayıcı</label>
                <p-select id="dataProviderId" [options]="dataProviderOptions" formControlName="dataProviderId"
                  placeholder="Seçiniz" appendTo="body" [class.ng-dirty.ng-invalid]="isFieldInvalid('dataProviderId')"
                  class="w-full" />
                <app-validation-message [control]="pageForm.controls['dataProviderId']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="dataSource">Data Kaynağı</label>
                <p-select id="dataSource" optionValue="id" optionLabel="name" [options]="dataSourceOptions"
                  formControlName="dataSource" placeholder="Seçiniz" appendTo="body"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('dataSource')" class="w-full" />
                <app-validation-message [control]="pageForm.controls['dataSource']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="regionId">Bölge</label>
                <p-select id="regionId" [options]="regionOptions" formControlName="regionId" placeholder="Seçiniz"
                  appendTo="body" [class.ng-dirty.ng-invalid]="isFieldInvalid('regionId')" class="w-full" />
                <app-validation-message [control]="pageForm.controls['regionId']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="">2.Telefon</label>
                <p-inputMask id="secondPhone" formControlName="secondPhone" class="w-full" [mask]="'(999) 999 99 99'"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('secondPhone')" />
                <app-validation-message [control]="pageForm.controls['secondPhone']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="email">E-posta</label>
                <input id="email" type="email" pInputText formControlName="email"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('email')" />
                <app-validation-message [control]="pageForm.controls['email']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="date">Tarih</label>
                <input id="date" type="text" pInputText [value]="currentDate | date:'dd.MM.yyyy HH:mm'" readonly />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="date">Satış Temsilcisi</label>
                <input id="date" type="text" pInputText [value]="currentUser" readonly />
              </div>

              <div class="col-span-12 md:col-span-4">
                <label for="status">Durumu</label>
                <p-select id="status" [options]="crmStatusOptions" formControlName="status" placeholder="Seçiniz"
                  appendTo="body" optionValue="id" optionLabel="name"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('status')" class="w-full"></p-select>
                <app-validation-message [control]="pageForm.controls['status']" />
              </div>

              <div class="col-span-12 md:col-span-4">
                <div class="flex items-center h-full">
                  <p-checkbox formControlName="excludeFromCommission" inputId="excludeFromCommission" [binary]="true" />
                  <label for="excludeFromCommission" class="ml-2">Prim Dışı Tut</label>
                </div>
              </div>

              <div class="col-span-12 md:col-span-8">
                <label for="description">Açıklama</label>
                <textarea pTextarea id="address" formControlName="description"
                  [class.ng-dirty.ng-invalid]="isFieldInvalid('description')" rows="3"></textarea>
                <app-validation-message [control]="pageForm.controls['description']" />
              </div>

            </div>
          </form>

        </p-fluid>
        <div class="flex justify-between items-center my-4">
          <!-- Sol: Satış Yap -->
          <div>
            <p-button *ngIf="pageForm.controls['id'].value" label="Satış Yap" severity="help" styleClass="animate-pulse"
              icon="pi pi-shopping-cart" (onClick)="openSalesModal()">
            </p-button>
          </div>

          <!-- Sağ: İptal ve Kaydet -->
          <div class="flex gap-2">
            <button pButton label="İptal" icon="pi pi-times" class="p-button-secondary" (click)="closeModal()"></button>
            <button pButton label="Kaydet" icon="pi pi-check" class="p-button-success" (click)="saveRecord()"
              [disabled]="pageForm.invalid">
            </button>
          </div>
        </div>

      </p-tabpanel>

      <p-tabpanel *ngIf="pageForm.controls['id'].value" value="1">
        <div class="mt-4">
          <form *ngIf="actionForm" [formGroup]="actionForm">
            <p-table [value]="crmActions" stripedRows>
              <ng-template #header>
                <tr>
                  <th style="width: 15%">İşlem Yapan</th>
                  <th style="width: 15%">İşlem Tarihi</th>
                  <th style="width: 20%">İşlem Türü</th>
                  <th style="width: 15%">Hedef Tarih</th>
                  <th style="width: 30%">Açıklama</th>
                  <th style="width: 5%"></th>
                </tr>
              </ng-template>
              <ng-template #body let-item>
                <tr>
                  <td>{{ item.employeeName }}</td>
                  <td>{{ item.date | date: 'dd.MM.yyyy' }}</td>
                  <td>{{ item.actionType | enumTranslate: CrmActionType :'CrmActionType' }}</td>
                  <td>{{ item.targetDate | date: 'dd.MM.yyyy' }}</td>
                  <td colspan="2">{{ item.description }}</td>
                </tr>
              </ng-template>
              <ng-template pTemplate="footer">
                <tr>
                  <td>{{ currentUser }}</td>
                  <td>{{ currentDate | date: 'dd.MM.yyyy' }}</td>
                  <td>
                    <p-select id="actionType" [options]="actionTypeOptions" formControlName="actionType"
                      placeholder="Seçiniz" appendTo="body" [class.ng-dirty.ng-invalid]="isFieldInvalid('actionType')"
                      class="w-full" />
                    <app-validation-message [control]="actionForm.controls['actionType']" />
                  </td>
                  <td>
                    <p-datepicker id="targetDate" formControlName="targetDate" appendTo="body" dateFormat="dd.mm.yy"
                      [class.ng-dirty.ng-invalid]="isFieldInvalid('targetDate')" class="w-full" />
                    <app-validation-message [control]="actionForm.controls['targetDate']" />
                  </td>
                  <td>
                    <textarea pTextarea id="description" formControlName="description"
                      [class.ng-dirty.ng-invalid]="isFieldInvalid('description')" rows="3" class="w-full"></textarea>
                    <app-validation-message [control]="actionForm.controls['description']" />
                  </td>
                  <td>
                    <p-button icon="pi pi-save" size="small" pTooltip="Kaydet" tooltipPosition="top" icon="pi pi-save"
                      [disabled]="actionForm.invalid" (click)="saveAction()" />
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </form>
        </div>
      </p-tabpanel>

      <p-tabpanel *ngIf="pageForm.controls['id'].value" value="2">
        <div class="mt-4 w-3/5 mx-auto">

          <form *ngIf="smsForm" [formGroup]="smsForm">
            <div>
              <p-fieldset legend="Telefon Numarası">
                <div class="flex items-center gap-3">
                  <div>
                    <label for="phone1" class="mr-2">Tel 1</label>
                    <p-radiobutton name="phoneOption" value="phone1" formControlName="phoneOption" inputId="phone1" />
                  </div>

                  <div *ngIf="pageForm.controls['secondPhone'].value">
                    <label for="phone2" class="mr-2">Tel 2</label>
                    <p-radiobutton name="phoneOption" value="phone2" formControlName="phoneOption" inputId="phone2" />
                  </div>

                  <div class="mr-2">
                    <label for="manual" class="mr-2">Elle Giriş</label>
                    <p-radiobutton name="phoneOption" value="manual" formControlName="phoneOption" inputId="manual" />
                  </div>

                  <div>
                    <p-inputMask formControlName="phone" class="w-full" [mask]="'(999) 999 99 99'"
                      [class.ng-dirty.ng-invalid]="isFieldInvalid('phone')" />
                  </div>
                </div>
              </p-fieldset>
            </div>
            <div class="mt-4">
              <p-fieldset legend="Mesaj" class="mt-4" styleClass="mt-4">
                <div class="flex items-center gap-3">
                  <div class="w-4/5">
                    <textarea pTextarea id="message" formControlName="message" class="w-full"
                      [class.ng-dirty.ng-invalid]="isFieldInvalid('message')" rows="3"></textarea>
                  </div>
                  <div class="w-1/5 h-full flex text-center justify-center flex-col">
                    <div>
                      <span>{{smsForm.controls['message'].value.length}}</span>
                      <span>/</span>
                      <span>250</span>
                    </div>
                    <p-button icon="pi pi-send" size="small" label="Gönder" [disabled]="smsForm.invalid"
                      (click)="saveAction()" />
                  </div>
                </div>
              </p-fieldset>
            </div>
          </form>

        </div>
      </p-tabpanel>

      <p-tabpanel *ngIf="pageForm.controls['id'].value" value="3">
        <p-table [value]="saleList" stripedRows>
          <ng-template #header>
            <tr>
              <th style="width: 15%">Satış Yapan</th>
              <th style="width: 15%">Satış Tarihi</th>
              <th class="!text-right" style="width: 1%;">Tutar</th>
            </tr>
          </ng-template>
          <ng-template #body let-item>
            <tr>
              <td>{{ item.employeeName }}</td>
              <td>{{ item.date | date: 'dd.MM.yyyy' }}</td>
              <td class="!text-right">
                <span class="amount">{{ item.amount | currency:'TRY' }}</span>
              </td>
            </tr>
          </ng-template>
          <ng-template #footer>
            <tr>
              <td colspan="2" class="!text-right !font-bold">Toplam</td>
              <td class="!text-right !font-bold">
                {{ getTotalAmount() | currency:'TRY' }}
              </td>
            </tr>
          </ng-template>
        </p-table>
        <div class="flex mt-6 justify-center">
          <p-button label="Satış Yap" severity="help" />
        </div>
      </p-tabpanel>

    </p-tabpanels>
  </p-tabs>

</app-dialog>

<app-dialog [(visible)]="showSalesModal" header="Satış Yap" (visibleChange)="visibleChangeSalesModal($emit)"
  [breakpoints]="{ '1920px': '40vw', '1366px': '50vw', '960px': '65vw', '640px': '95vw' }">
  <form [formGroup]="salesForm">

    <p-stepper [value]="activeStep" class="basis-[50rem]" [linear]="true">
      <p-step-list>
        <p-step [value]="1">Öğrenci ve Veli Bilgileri</p-step>
        <p-step [value]="2">Eğitim Bilgileri</p-step>
        <p-step [value]="3">Senet Bilgileri</p-step>
      </p-step-list>

      <p-step-panels>

        <p-step-panel [value]="1" [formGroup]="salesForm.get('step1')">

          <ng-template #content>

            <p-fieldset legend="Öğrenci Bilgileri">
              <p-fluid>
                <div class="grid grid-cols-12 gap-4">

                  <div class="col-span-12 md:col-span-4">
                    <label for="firstName">Ad</label>
                    <input pInputText formControlName="firstName"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('firstName')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['firstName']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="lastName">Soyad</label>
                    <input pInputText formControlName="lastName"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('lastName')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['lastName']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="identityNumber">T.C Kimlik</label>
                    <p-inputMask formControlName="identityNumber" [mask]="'99999999999'"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('identityNumber')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['identityNumber']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="birthDate">Doğum Tarihi</label>
                    <p-datepicker id="birthDate" formControlName="birthDate" appendTo="body" dateFormat="dd.mm.yy"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('birthDate')" class="w-full" />
                    <app-validation-message [control]="salesForm.get('step1').controls['birthDate']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="phone">Telefon</label>
                    <p-inputMask id="phone" formControlName="phone" class="w-full" [mask]="'(999) 999 99 99'"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('phone')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['phone']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="secondPhone">2.Telefon</label>
                    <p-inputMask id="secondPhone" formControlName="secondPhone" class="w-full"
                      [mask]="'(999) 999 99 99'" [class.ng-dirty.ng-invalid]="isFieldInvalidSales('secondPhone')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['secondPhone']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="email">E-Posta</label>
                    <input id="email" type="email" pInputText formControlName="email"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('email')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['email']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="studentType">Tahsil Durumu</label>
                    <p-select id="studentType" [options]="studentTypeOptions" class="w-full"
                      formControlName="studentType" placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('studentType')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['studentType']" />
                  </div>

                  <div class="col-span-12 md:col-span-4 col-start-1 md:col-start-1">
                    <label for="cityId">İl</label>
                    <p-select id="cityId" [options]="cityOptions" class="w-full" formControlName="cityId"
                      placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('cityId')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['cityId']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="districtId">İlçe</label>
                    <p-select id="districtId" [options]="districtOptions" class="w-full" formControlName="districtId"
                      placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('districtId')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['districtId']" />
                  </div>

                  <div class="col-span-12 md:col-span-8 col-start-1 md:col-start-1">
                    <label for="address">Adres</label>
                    <textarea pTextarea id="address" formControlName="address"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('address')" rows="3"></textarea>
                    <app-validation-message [control]="salesForm.get('step1').controls['address']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label class="text-red-800 font-bold">Sözleşmeyi Kim İmzalayacak?</label>
                    <div class="flex flex-wrap gap-4 mt-4">

                      <div class="flex items-center">
                        <p-radiobutton name="signatory" value="student" formControlName="signatory" inputId="student" />
                        <label for="student" class="ml-2">Öğrenci</label>
                      </div>

                      <div class="flex items-center">
                        <p-radiobutton name="signatory" value="parent" formControlName="signatory" inputId="parent" />
                        <label for="parent" class="ml-2">Veli</label>
                      </div>

                    </div>
                    <app-validation-message [control]="salesForm.get('step1').controls['signatory']" />
                  </div>

                </div>
              </p-fluid>
            </p-fieldset>

            <p-fieldset legend="Veli Bilgileri" class="mt-4">
              <p-fluid>
                <div class="grid grid-cols-12 gap-4">

                  <div class="col-span-12 md:col-span-4">
                    <label for="parentFirstName">Ad</label>
                    <input pInputText formControlName="parentFirstName"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('parentFirstName')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['parentFirstName']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="parentLastName">Soyad</label>
                    <input pInputText formControlName="parentLastName"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('parentLastName')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['parentLastName']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="parentIdentityNumber">T.C Kimlik</label>
                    <p-inputMask formControlName="parentIdentityNumber" [mask]="'99999999999'"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('parentIdentityNumber')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['parentIdentityNumber']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="parentBirthDate">Doğum Tarihi</label>
                    <p-datepicker id="parentBirthDate" formControlName="parentBirthDate" appendTo="body"
                      dateFormat="dd.mm.yy" [class.ng-dirty.ng-invalid]="isFieldInvalidSales('parentBirthDate')"
                      class="w-full" />
                    <app-validation-message [control]="salesForm.get('step1').controls['parentBirthDate']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="parentPhone">Telefon</label>
                    <p-inputMask id="parentPhone" formControlName="parentPhone" class="w-full"
                      [mask]="'(999) 999 99 99'" [class.ng-dirty.ng-invalid]="isFieldInvalidSales('parentPhone')" />
                    <app-validation-message [control]="salesForm.get('step1').controls['parentPhone']" />
                  </div>

                </div>
              </p-fluid>
            </p-fieldset>

            <div class="flex pt-6 justify-end">
              <p-button label="İleri" icon="pi pi-arrow-right" iconPos="right" (onClick)="nextStep()" />
            </div>
          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="2" [formGroup]="salesForm.get('step2')">
          <ng-template #content>
            <p-fieldset legend="Sözleşme Türü">
              <p-fluid>
                <div class="grid grid-cols-12 gap-4 my-4">

                  <div class="col-span-12 md:col-span-6">
                    <div class="flex flex-wrap gap-4 mt-4">

                      <div class="flex items-center">
                        <p-radiobutton name="contractType" value="Genel" formControlName="contractType"
                          inputId="genel" />
                        <label for="genel" class="ml-2">Genel</label>
                      </div>

                      <div class="flex items-center">
                        <p-radiobutton name="contractType" value="Özel Ders" formControlName="contractType"
                          inputId="ozelDers" />
                        <label for="ozelDers" class="ml-2">Özel Ders</label>
                      </div>

                    </div>
                    <app-validation-message [control]="salesForm.get('step2').controls['firstName']" />
                  </div>

                  <div class="col-span-12 md:col-span-6">
                    <div class="flex flex-wrap gap-4 mt-4">

                      <div class="flex items-center">
                        <p-radiobutton name="educationType" value="Yüzyüze" formControlName="educationType"
                          inputId="yuzyuze" />
                        <label for="yuzyuze" class="ml-2">Yüzyüze</label>
                      </div>

                      <div class="flex items-center">
                        <p-radiobutton name="educationType" value="Online" formControlName="educationType"
                          inputId="online" />
                        <label for="online" class="ml-2">Online</label>
                      </div>

                    </div>
                    <app-validation-message [control]="salesForm.get('step2').controls['firstName']" />
                  </div>

                </div>
              </p-fluid>
            </p-fieldset>

            <div class="grid grid-cols-12 gap-4">

              <div class="col-span-12 md:col-span-6">
                <p-fieldset legend="Ders Programı">
                  <p-fluid>
                    <div class="grid grid-cols-12 gap-4">

                      <div class="col-span-12 md:col-span-6">
                        <p-select id="lessonScheduleId" [options]="lessonScheduleOptions"
                          formControlName="lessonScheduleId" placeholder="Seçiniz" appendTo="body"
                          [class.ng-dirty.ng-invalid]="isFieldInvalidSales('lessonScheduleId')" class="w-full" />
                        <app-validation-message [control]="salesForm.get('step2').controls['lessonScheduleId']" />
                      </div>

                    </div>
                  </p-fluid>
                </p-fieldset>
              </div>

              <div class="col-span-12 md:col-span-6">
                <p-fieldset legend="Eğitim Süresi">
                  <p-fluid>
                    <div class="grid grid-cols-12 gap-4">

                      <div class="col-span-12 md:col-span-6">
                        <p-select id="educationDuration" [options]="educationDurationOptions"
                          formControlName="educationDuration" placeholder="Seçiniz" appendTo="body"
                          [class.ng-dirty.ng-invalid]="isFieldInvalidSales('educationDuration')" class="w-full" />
                        <app-validation-message [control]="salesForm.get('step2').controls['educationDuration']" />
                      </div>

                    </div>
                  </p-fluid>
                </p-fieldset>
              </div>

            </div>

            <p-fieldset legend="Ödeme Bilgileri">
              <p-fluid>
                <div class="grid grid-cols-12 gap-4">

                  <div class="col-span-12 md:col-span-6">
                    <label for="campaignId">Kampanya</label>
                    <p-select id="campaignId" [options]="paymentTypeOptions" formControlName="campaignId"
                      placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('campaignId')" class="w-full" />
                    <app-validation-message [control]="salesForm.get('step2').controls['campaignId']" />
                  </div>

                  <div class="col-span-12 md:col-span-6">
                    <label for="discountId">Gerekçeli İndirim</label>
                    <p-select id="discountId" [options]="discountOptions" formControlName="discountId"
                      placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('discountId')" class="w-full" />
                    <app-validation-message [control]="salesForm.get('step2').controls['discountId']" />
                  </div>

                  <div class="col-span-12 md:col-span-6">
                    <label for="paymentMethod">Ödeme Türü</label>
                    <div class="flex flex-wrap gap-4 mt-4">

                      <div class="flex items-center">
                        <p-radiobutton name="paymentMethod" value="Senet" formControlName="paymentMethod"
                          inputId="senet" />
                        <label for="senet" class="ml-2">Senet</label>
                      </div>

                      <div class="flex items-center">
                        <p-radiobutton name="paymentMethod" value="Kredi Kartı" formControlName="paymentMethod"
                          inputId="krediKarti" />
                        <label for="krediKarti" class="ml-2">Kredi Kartı</label>
                      </div>

                    </div>
                    <app-validation-message [control]="salesForm.get('step2').controls['paymentType']" />
                  </div>

                  <div class="col-span-12 md:col-span-4">
                    <label for="installmentCount">Taksit Sayısı</label>
                    <p-select id="installmentCount" [options]="installmentCountOptions"
                      formControlName="installmentCount" placeholder="Seçiniz" appendTo="body"
                      [class.ng-dirty.ng-invalid]="isFieldInvalidSales('installmentCount')" class="w-full" />
                    <app-validation-message [control]="salesForm.get('step2').controls['installmentCount']" />
                  </div>
                  <div class="col-span-12 md:col-span-2">
                    <p-checkbox formControlName="isCash" inputId="isCash" [binary]="true"></p-checkbox>
                    <label for="isCash" class="ml-2">Nakit</label>
                  </div>
                </div>
              </p-fluid>

            </p-fieldset>

          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="3">
          <ng-template #content>
            <div class="flex flex-col h-48">
              <div
                class="border-2 border-dashed border-surface-200 dark:border-surface-700 rounded bg-surface-50 dark:bg-surface-950 flex-auto flex justify-center items-center font-medium">
                Content III
              </div>
            </div>
            <div class="flex pt-6 justify-start">
              <p-button label="Back" icon="pi pi-arrow-left" iconPos="right" (onClick)="completeStep()" />
            </div>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>

  </form>
</app-dialog>

<p-confirmdialog #cd>
  <ng-template #headless let-message let-onAccept="onAccept" let-onReject="onReject">
    <div class="flex flex-col items-center p-8 bg-surface-0 dark:bg-surface-900 rounded">
      <div
        class="rounded-full bg-primary text-primary-contrast inline-flex justify-center items-center h-24 w-24 -mt-20">
        <i class="pi pi-info !text-5xl"></i>
      </div>
      <p class="mb-0">
        Bu numara sistemde kayıtlı bir dataya ait.<br>
        Şimdi bu dataya yönlendireleceksiniz.<br>
        Bugün veya yarın tarihli bir <strong>'Tekrar Ara'</strong> işlemi yapın.<br>
        Protokol kuralları otomatik olarak işletilecek ve bu data, ya önceki sahibinde kalacak ya da size geçecek.<br>
        Ancak her iki durumda da data tekrar değerlendirilebilir ve yenilenmiş olarak kuruma kazandırılmış olacak.
      </p>
      <div class="flex items-center gap-2 mt-6">
        <p-button label="Tamam" (onClick)="onAccept()" styleClass="w-32"></p-button>
      </div>
    </div>
  </ng-template>
</p-confirmdialog>